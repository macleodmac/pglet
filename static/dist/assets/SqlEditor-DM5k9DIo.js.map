{"version":3,"file":"SqlEditor-DM5k9DIo.js","sources":["../../../frontend/src/components/editor/autocomplete.ts","../../../frontend/src/components/editor/SqlEditor.tsx"],"sourcesContent":["import type * as monaco from 'monaco-editor'\nimport { queryClient } from '../../queryClient'\nimport type { SchemaGroup, SchemaObject } from '../../api/generated'\n\nconst PG_KEYWORDS = [\n  'SELECT', 'FROM', 'WHERE', 'AND', 'OR', 'NOT', 'IN', 'IS', 'NULL', 'AS',\n  'JOIN', 'LEFT', 'RIGHT', 'INNER', 'OUTER', 'FULL', 'CROSS', 'ON',\n  'INSERT', 'INTO', 'VALUES', 'UPDATE', 'SET', 'DELETE',\n  'CREATE', 'ALTER', 'DROP', 'TABLE', 'INDEX', 'VIEW', 'SCHEMA',\n  'GROUP', 'BY', 'ORDER', 'ASC', 'DESC', 'LIMIT', 'OFFSET',\n  'HAVING', 'DISTINCT', 'UNION', 'ALL', 'INTERSECT', 'EXCEPT',\n  'EXISTS', 'BETWEEN', 'LIKE', 'ILIKE', 'SIMILAR', 'TO',\n  'CASE', 'WHEN', 'THEN', 'ELSE', 'END',\n  'CAST', 'COALESCE', 'NULLIF', 'GREATEST', 'LEAST',\n  'COUNT', 'SUM', 'AVG', 'MIN', 'MAX', 'ARRAY_AGG', 'STRING_AGG',\n  'NOW', 'CURRENT_TIMESTAMP', 'CURRENT_DATE', 'CURRENT_TIME',\n  'TRUE', 'FALSE', 'DEFAULT',\n  'PRIMARY', 'KEY', 'FOREIGN', 'REFERENCES', 'UNIQUE', 'CHECK', 'CONSTRAINT',\n  'WITH', 'RECURSIVE', 'RETURNING',\n  'EXPLAIN', 'ANALYZE', 'VERBOSE',\n  'BEGIN', 'COMMIT', 'ROLLBACK', 'SAVEPOINT',\n  'GRANT', 'REVOKE',\n  'TRIGGER', 'FUNCTION', 'PROCEDURE', 'RETURNS', 'LANGUAGE',\n  'IF', 'ELSIF', 'LOOP', 'FOR', 'WHILE', 'DECLARE',\n  'TEXT', 'INTEGER', 'BIGINT', 'SMALLINT', 'BOOLEAN', 'VARCHAR', 'CHAR',\n  'NUMERIC', 'DECIMAL', 'REAL', 'DOUBLE', 'PRECISION', 'SERIAL', 'BIGSERIAL',\n  'TIMESTAMP', 'DATE', 'TIME', 'INTERVAL', 'JSON', 'JSONB', 'UUID', 'BYTEA',\n]\n\nconst PG_FUNCTIONS = [\n  'count', 'sum', 'avg', 'min', 'max', 'array_agg', 'string_agg', 'json_agg', 'jsonb_agg',\n  'now', 'current_timestamp', 'current_date', 'age', 'date_trunc', 'date_part', 'extract',\n  'length', 'lower', 'upper', 'trim', 'ltrim', 'rtrim', 'substring', 'replace', 'concat',\n  'split_part', 'regexp_replace', 'regexp_matches', 'left', 'right', 'repeat', 'reverse',\n  'abs', 'ceil', 'floor', 'round', 'trunc', 'mod', 'power', 'sqrt', 'random',\n  'coalesce', 'nullif', 'greatest', 'least',\n  'row_number', 'rank', 'dense_rank', 'lag', 'lead', 'first_value', 'last_value', 'ntile',\n  'to_char', 'to_date', 'to_timestamp', 'to_number',\n  'json_build_object', 'jsonb_build_object', 'json_extract_path', 'jsonb_extract_path_text',\n  'array_length', 'unnest', 'generate_series',\n  'pg_size_pretty', 'pg_total_relation_size', 'pg_table_size', 'pg_indexes_size',\n]\n\n// Parse the SQL text to find table references after FROM and JOIN\nfunction findTableReferences(text: string): string[] {\n  const tables: string[] = []\n  const regex = /\\b(?:FROM|JOIN)\\s+([a-zA-Z_][a-zA-Z0-9_]*(?:\\.[a-zA-Z_][a-zA-Z0-9_]*)?)/gi\n  let match\n  while ((match = regex.exec(text)) !== null) {\n    tables.push(match[1])\n  }\n  return tables\n}\n\nexport function createCompletionProvider(monacoInstance: typeof monaco): monaco.languages.CompletionItemProvider {\n  return {\n    triggerCharacters: ['.', ' '],\n    provideCompletionItems(model, position) {\n      const word = model.getWordUntilPosition(position)\n      const range: monaco.IRange = {\n        startLineNumber: position.lineNumber,\n        endLineNumber: position.lineNumber,\n        startColumn: word.startColumn,\n        endColumn: word.endColumn,\n      }\n\n      const suggestions: monaco.languages.CompletionItem[] = []\n      const objects = queryClient.getQueryData<Record<string, SchemaGroup>>(['objects'])\n\n      // SQL keywords\n      for (const kw of PG_KEYWORDS) {\n        suggestions.push({\n          label: kw,\n          kind: monacoInstance.languages.CompletionItemKind.Keyword,\n          insertText: kw,\n          range,\n          sortText: '3_' + kw,\n        })\n      }\n\n      // Built-in functions\n      for (const fn of PG_FUNCTIONS) {\n        suggestions.push({\n          label: fn,\n          kind: monacoInstance.languages.CompletionItemKind.Function,\n          insertText: fn + '($0)',\n          insertTextRules: monacoInstance.languages.CompletionItemInsertTextRule.InsertAsSnippet,\n          range,\n          sortText: '2_' + fn,\n        })\n      }\n\n      if (!objects) return { suggestions }\n\n      // Table and view names from schema objects\n      const allTables: SchemaObject[] = []\n      for (const [schema, group] of Object.entries(objects)) {\n        const schemaObjects = [\n          ...group.tables,\n          ...group.views,\n          ...group.materialized_views,\n        ]\n        for (const obj of schemaObjects) {\n          allTables.push(obj)\n          const label = schema === 'public' ? obj.name : `${schema}.${obj.name}`\n          suggestions.push({\n            label,\n            kind: monacoInstance.languages.CompletionItemKind.Class,\n            insertText: label,\n            detail: obj.type,\n            range,\n            sortText: '1_' + label,\n          })\n        }\n\n        // User-defined functions\n        for (const fn of group.functions) {\n          const label = schema === 'public' ? fn.name : `${schema}.${fn.name}`\n          suggestions.push({\n            label,\n            kind: monacoInstance.languages.CompletionItemKind.Function,\n            insertText: label + '($0)',\n            insertTextRules: monacoInstance.languages.CompletionItemInsertTextRule.InsertAsSnippet,\n            range,\n            sortText: '2_' + label,\n          })\n        }\n      }\n\n      // Column completion: check if cursor is after a table reference\n      const fullText = model.getValue()\n      const tableRefs = findTableReferences(fullText)\n\n      for (const ref of tableRefs) {\n        const qualifiedName = ref.includes('.') ? ref : `public.${ref}`\n        const [schema, table] = qualifiedName.split('.')\n\n        // Look up cached column data\n        const columns = queryClient.getQueryData<Array<{ name: string; type: string }>>(\n          ['table-columns', ref],\n        ) ?? queryClient.getQueryData<Array<{ name: string; type: string }>>(\n          ['table-columns', `${schema}.${table}`],\n        )\n\n        if (columns) {\n          for (const col of columns) {\n            suggestions.push({\n              label: col.name,\n              kind: monacoInstance.languages.CompletionItemKind.Field,\n              insertText: col.name,\n              detail: `${col.type} (${ref})`,\n              range,\n              sortText: '0_' + col.name,\n            })\n          }\n        }\n      }\n\n      return { suggestions }\n    },\n  }\n}\n","import Editor, { type OnMount } from '@monaco-editor/react'\nimport { useCallback, useRef, useImperativeHandle, forwardRef } from 'react'\nimport type { editor as MonacoEditor } from 'monaco-editor'\nimport { formatDialect } from '@avallete/sql-formatter/lite'\nimport { postgresql } from '@avallete/sql-formatter/languages/postgresql'\nimport { createCompletionProvider } from './autocomplete'\nimport { useThemeStore } from '../../stores/theme'\n\nlet completionRegistered = false\nlet themesRegistered = false\n\nexport interface SqlEditorHandle {\n  getSelectedText: () => string | undefined\n  formatSql: () => void\n}\n\ninterface SqlEditorProps {\n  value: string\n  onChange: (value: string) => void\n  onRun: (selectedText?: string) => void\n  onExplain: () => void\n  onSave?: () => void\n}\n\nexport const SqlEditor = forwardRef<SqlEditorHandle, SqlEditorProps>(function SqlEditor(\n  { value, onChange, onRun, onExplain, onSave },\n  ref,\n) {\n  const editorRef = useRef<MonacoEditor.IStandaloneCodeEditor | null>(null)\n\n  useImperativeHandle(ref, () => ({\n    getSelectedText: () => {\n      const ed = editorRef.current\n      if (!ed) return undefined\n      const selection = ed.getSelection()\n      const model = ed.getModel()\n      if (selection && !selection.isEmpty() && model) {\n        const text = model.getValueInRange(selection)\n        return text.trim() ? text : undefined\n      }\n      return undefined\n    },\n    formatSql: () => {\n      const ed = editorRef.current\n      if (!ed) return\n      const model = ed.getModel()\n      if (!model) return\n      const text = model.getValue()\n      if (!text.trim()) return\n      try {\n        const formatted = formatDialect(text, {\n          dialect: postgresql,\n          tabWidth: 2,\n          keywordCase: 'upper',\n        })\n        model.setValue(formatted)\n      } catch {\n        // leave text unchanged on parse error\n      }\n    },\n  }))\n  const onRunRef = useRef(onRun)\n  const onExplainRef = useRef(onExplain)\n  const onSaveRef = useRef(onSave)\n  onRunRef.current = onRun\n  onExplainRef.current = onExplain\n  onSaveRef.current = onSave\n\n  const handleMount: OnMount = useCallback(\n    (editor, monaco) => {\n      editorRef.current = editor\n\n      if (!themesRegistered) {\n        monaco.editor.defineTheme('pglet-light', {\n          base: 'vs',\n          inherit: true,\n          rules: [\n            { token: 'keyword', foreground: '3d7568', fontStyle: 'bold' },\n            { token: 'keyword.sql', foreground: '3d7568', fontStyle: 'bold' },\n            { token: 'operator.sql', foreground: '4f9385' },\n            { token: 'predefined.sql', foreground: '4f9385' },\n            { token: 'string.sql', foreground: 'b45309' },\n            { token: 'number', foreground: 'c2410c' },\n            { token: 'comment', foreground: 'a8a29e', fontStyle: 'italic' },\n          ],\n          colors: {\n            'editor.selectionBackground': '#b1e0d4',\n            'editor.inactiveSelectionBackground': '#d6efe8',\n            'editor.selectionHighlightBackground': '#d6efe880',\n            'editorCursor.foreground': '#4f9385',\n          },\n        })\n        monaco.editor.defineTheme('pglet-dark', {\n          base: 'vs-dark',\n          inherit: true,\n          rules: [\n            { token: 'keyword', foreground: 'b1e0d4', fontStyle: 'bold' },\n            { token: 'keyword.sql', foreground: 'b1e0d4', fontStyle: 'bold' },\n            { token: 'operator.sql', foreground: '92c5b9' },\n            { token: 'predefined.sql', foreground: '92c5b9' },\n            { token: 'string.sql', foreground: 'fcd34d' },\n            { token: 'number', foreground: 'fb923c' },\n            { token: 'comment', foreground: '78716c', fontStyle: 'italic' },\n          ],\n          colors: {\n            'editor.selectionBackground': '#2f5b51',\n            'editor.inactiveSelectionBackground': '#2f5b5180',\n            'editor.selectionHighlightBackground': '#2f5b5160',\n            'editorCursor.foreground': '#b1e0d4',\n          },\n        })\n        themesRegistered = true\n      }\n\n      if (!completionRegistered) {\n        monaco.languages.registerCompletionItemProvider('sql', createCompletionProvider(monaco))\n        completionRegistered = true\n      }\n\n      // Use addCommand for Cmd+Enter â€” more reliable than addAction for keybindings\n      editor.addCommand(monaco.KeyMod.CtrlCmd | monaco.KeyCode.Enter, () => {\n        const selection = editor.getSelection()\n        const model = editor.getModel()\n        if (selection && !selection.isEmpty() && model) {\n          const selectedText = model.getValueInRange(selection)\n          if (selectedText.trim()) {\n            onRunRef.current(selectedText)\n            return\n          }\n        }\n        onRunRef.current()\n      })\n\n      // Cmd+Shift+Enter: run selection only (no fallback)\n      editor.addCommand(\n        monaco.KeyMod.CtrlCmd | monaco.KeyMod.Shift | monaco.KeyCode.Enter,\n        () => {\n          const selection = editor.getSelection()\n          const model = editor.getModel()\n          if (selection && !selection.isEmpty() && model) {\n            const selectedText = model.getValueInRange(selection)\n            if (selectedText.trim()) {\n              onRunRef.current(selectedText)\n            }\n          }\n        },\n      )\n\n      editor.addAction({\n        id: 'explain-query',\n        label: 'Explain Query',\n        keybindings: [monaco.KeyMod.CtrlCmd | monaco.KeyCode.KeyE],\n        run: () => onExplainRef.current(),\n      })\n\n      editor.addAction({\n        id: 'save-query',\n        label: 'Save Query',\n        keybindings: [monaco.KeyMod.CtrlCmd | monaco.KeyCode.KeyS],\n        run: () => onSaveRef.current?.(),\n      })\n\n      editor.addAction({\n        id: 'format-sql',\n        label: 'Format SQL',\n        keybindings: [monaco.KeyMod.Alt | monaco.KeyMod.Shift | monaco.KeyCode.KeyF],\n        run: (ed) => {\n          const model = ed.getModel()\n          if (!model) return\n          const text = model.getValue()\n          if (!text.trim()) return\n          try {\n            const formatted = formatDialect(text, {\n              dialect: postgresql,\n              tabWidth: 2,\n              keywordCase: 'upper',\n            })\n            model.setValue(formatted)\n          } catch {\n            // leave text unchanged on parse error\n          }\n        },\n      })\n\n      editor.focus()\n    },\n    [],\n  )\n\n  const theme = useThemeStore((s) => s.theme)\n  const isDark =\n    theme === 'dark' ||\n    (theme === 'system' && window.matchMedia('(prefers-color-scheme: dark)').matches)\n\n  return (\n    <Editor\n      height=\"100%\"\n      defaultLanguage=\"sql\"\n      theme={isDark ? 'pglet-dark' : 'pglet-light'}\n      value={value}\n      onChange={(v) => onChange(v ?? '')}\n      onMount={handleMount}\n      options={{\n        minimap: { enabled: false },\n        lineNumbers: 'on',\n        fontSize: 13,\n        fontFamily: \"'IBM Plex Mono', 'JetBrains Mono', monospace\",\n        scrollBeyondLastLine: false,\n        wordWrap: 'on',\n        automaticLayout: true,\n        tabSize: 2,\n        padding: { top: 8 },\n        quickSuggestions: true,\n        suggestOnTriggerCharacters: true,\n      }}\n    />\n  )\n})\n"],"names":["PG_KEYWORDS","PG_FUNCTIONS","findTableReferences","text","tables","regex","match","createCompletionProvider","monacoInstance","model","position","word","range","suggestions","objects","queryClient","kw","fn","schema","group","schemaObjects","obj","label","fullText","tableRefs","ref","qualifiedName","table","columns","col","completionRegistered","themesRegistered","SqlEditor","forwardRef","value","onChange","onRun","onExplain","onSave","editorRef","useRef","useImperativeHandle","ed","selection","formatted","formatDialect","postgresql","onRunRef","onExplainRef","onSaveRef","handleMount","useCallback","editor","monaco","selectedText","theme","useThemeStore","s","isDark","jsx","Editor","v"],"mappings":"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"}